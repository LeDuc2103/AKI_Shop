<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <title>‚úÖ ƒê√É S·ª¨A XONG - Ph√¢n quy·ªÅn "Quan ly"</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            font-family: Arial, sans-serif;
            padding: 20px;
        }
        
        .container {
            max-width: 1000px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 80px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            margin: 30px auto;
        }
        
        .header {
            background: linear-gradient(135deg, #088178 0%, #066d63 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }
        
        .content {
            padding: 40px;
        }
        
        .step-box {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            border-left: 5px solid #088178;
        }
        
        .btn-custom {
            padding: 15px 30px;
            margin: 10px;
            border-radius: 30px;
            font-size: 1.1em;
            text-decoration: none;
            display: inline-block;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: #088178;
            color: white;
        }
        
        .btn-success {
            background: #28a745;
            color: white;
        }
        
        .btn-info {
            background: #17a2b8;
            color: white;
        }
        
        .btn-custom:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .code-box {
            background: #2d3748;
            color: #68d391;
            padding: 20px;
            border-radius: 10px;
            overflow-x: auto;
            font-family: monospace;
            margin: 15px 0;
        }
        
        .highlight {
            background: #fff3cd;
            padding: 2px 6px;
            border-radius: 3px;
            color: #856404;
            font-weight: bold;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-check-circle"></i> ƒê√É S·ª¨A XONG!</h1>
            <p style="font-size: 1.3em; margin: 10px 0 0 0;">Ph√¢n quy·ªÅn theo "Quan ly" trong database</p>
        </div>

        <div class="content">
            <div class="alert alert-success" style="background: #d4edda; padding: 20px; border-radius: 10px; border-left: 5px solid #28a745;">
                <h4><i class="fas fa-check-double"></i> ƒê√£ c·∫≠p nh·∫≠t th√†nh c√¥ng:</h4>
                <ul style="line-height: 2; margin: 10px 0 0 0;">
                    <li>‚úÖ <strong>login.php</strong> - ƒê√£ s·ª≠a ki·ªÉm tra <span class="highlight">vai_tro = "Quan ly"</span></li>
                    <li>‚úÖ <strong>admin.php</strong> - ƒê√£ s·ª≠a query ki·ªÉm tra vai_tro</li>
                    <li>‚úÖ T√†i kho·∫£n c√≥ vai_tro = <span class="highlight">"Quan ly"</span> ‚Üí Chuy·ªÉn ƒë·∫øn <strong>admin.php</strong></li>
                </ul>
            </div>

            <div class="step-box">
                <h3><i class="fas fa-database"></i> B∆Ø·ªöC 1: Ki·ªÉm tra vai_tro trong database</h3>
                <p>Xem gi√° tr·ªã vai_tro th·ª±c t·∫ø trong b·∫£ng user:</p>
                <div class="text-center">
                    <a href="check_vaitro.php" class="btn-custom btn-info" target="_blank">
                        <i class="fas fa-search"></i> Ki·ªÉm Tra Vai Tr√≤
                    </a>
                </div>
            </div>

            <div class="step-box">
                <h3><i class="fas fa-sign-in-alt"></i> B∆Ø·ªöC 2: ƒêƒÉng nh·∫≠p</h3>
                <p>ƒêƒÉng nh·∫≠p b·∫±ng t√†i kho·∫£n c√≥ <strong>vai_tro = "Quan ly"</strong>:</p>
                <div class="text-center">
                    <a href="login.php" class="btn-custom btn-primary">
                        <i class="fas fa-key"></i> ƒêƒÉng Nh·∫≠p Ngay
                    </a>
                </div>
            </div>

            <div class="step-box">
                <h3><i class="fas fa-code"></i> Thay ƒë·ªïi trong code:</h3>

                <h5>üìù login.php - Logic ph√¢n quy·ªÅn M·ªöI:</h5>
                <div class="code-box">
                    // L·∫•y vai tr√≤ v√† chuy·ªÉn v·ªÅ ch·ªØ th∆∞·ªùng $vai_tro = strtolower(trim($user['vai_tro'])); // PH√ÇN QUY·ªÄN: "Quan ly" ho·∫∑c "admin" ‚Üí admin.php if ($vai_tro === 'quan ly' || $vai_tro === 'quanly' || $vai_tro === 'admin') { // T√†i kho·∫£n QU·∫¢N L√ù/ADMIN ‚Üí admin.php
                    $_SESSION['admin_logged_in'] = true; header('Location: admin.php'); exit(); } else { // T√†i kho·∫£n USER ‚Üí index.php header('Location: index.php'); exit(); }
                </div>

                <h5>üìù admin.php - Query ki·ªÉm tra M·ªöI:</h5>
                <div class="code-box">
                    // L·∫•y th√¥ng tin admin $stmt = $conn->prepare("SELECT * FROM user WHERE email = ? AND (LOWER(vai_tro) = 'quan ly' OR LOWER(vai_tro) = 'quanly' OR LOWER(vai_tro) = 'admin')");
                </div>
            </div>

            <div class="alert alert-info" style="background: #d1ecf1; padding: 20px; border-radius: 10px; border-left: 5px solid #17a2b8;">
                <h4><i class="fas fa-info-circle"></i> C√°ch ho·∫°t ƒë·ªông:</h4>
                <ol style="line-height: 2.5; font-size: 1.05em;">
                    <li>L·∫•y <code>vai_tro</code> t·ª´ b·∫£ng <strong>user</strong></li>
                    <li>Chuy·ªÉn v·ªÅ ch·ªØ th∆∞·ªùng: <code>strtolower(trim($vai_tro))</code></li>
                    <li>So s√°nh v·ªõi:
                        <ul style="margin-top: 10px;">
                            <li><span class="highlight">'quan ly'</span> (c√≥ d·∫•u c√°ch)</li>
                            <li><span class="highlight">'quanly'</span> (kh√¥ng d·∫•u c√°ch)</li>
                            <li><span class="highlight">'admin'</span> (truy·ªÅn th·ªëng)</li>
                        </ul>
                    </li>
                    <li>N·∫øu tr√πng kh·ªõp ‚Üí Chuy·ªÉn ƒë·∫øn <strong>admin.php</strong></li>
                    <li>N·∫øu kh√¥ng ‚Üí Chuy·ªÉn ƒë·∫øn <strong>index.php</strong></li>
                </ol>
            </div>

            <div class="alert alert-warning" style="background: #fff3cd; padding: 20px; border-radius: 10px; border-left: 5px solid #ffc107;">
                <h4><i class="fas fa-exclamation-triangle"></i> L∆∞u √Ω quan tr·ªçng:</h4>
                <ul style="line-height: 2;">
                    <li>Vai tr√≤ trong database: <span class="highlight">"Quan ly"</span> (ch·ªØ Q hoa, l th∆∞·ªùng, c√≥ d·∫•u c√°ch)</li>
                    <li>Code so s√°nh ch·ªØ th∆∞·ªùng: <code>'quan ly'</code></li>
                    <li>T√†i kho·∫£n ph·∫£i c√≥ <code>trang_thai = 'active'</code></li>
                    <li>Password ƒë∆∞·ª£c m√£ h√≥a MD5</li>
                </ul>
            </div>

            <div class="alert alert-success" style="background: #d4edda; padding: 20px; border-radius: 10px; border-left: 5px solid #28a745;">
                <h4><i class="fas fa-check-circle"></i> K·∫øt qu·∫£ mong ƒë·ª£i:</h4>
                <table style="width: 100%; margin-top: 15px;">
                    <tr style="background: #f8f9fa;">
                        <th style="padding: 12px; border: 1px solid #ddd;">vai_tro trong DB</th>
                        <th style="padding: 12px; border: 1px solid #ddd;">Chuy·ªÉn ƒë·∫øn</th>
                    </tr>
                    <tr>
                        <td style="padding: 12px; border: 1px solid #ddd;"><strong>"Quan ly"</strong></td>
                        <td style="padding: 12px; border: 1px solid #ddd;"><strong>‚Üí admin.php ‚úÖ</strong></td>
                    </tr>
                    <tr>
                        <td style="padding: 12px; border: 1px solid #ddd;"><strong>"admin"</strong></td>
                        <td style="padding: 12px; border: 1px solid #ddd;"><strong>‚Üí admin.php ‚úÖ</strong></td>
                    </tr>
                    <tr>
                        <td style="padding: 12px; border: 1px solid #ddd;">"user", "nhanvien", kh√°c</td>
                        <td style="padding: 12px; border: 1px solid #ddd;">‚Üí index.php</td>
                    </tr>
                </table>
            </div>

            <div class="text-center" style="margin-top: 40px;">
                <a href="check_vaitro.php" class="btn-custom btn-info" target="_blank">
                    <i class="fas fa-database"></i> 1. Ki·ªÉm Tra Database
                </a>
                <a href="login.php" class="btn-custom btn-primary">
                    <i class="fas fa-sign-in-alt"></i> 2. ƒêƒÉng Nh·∫≠p
                </a>
            </div>

            <div style="margin-top: 30px; padding: 20px; background: #e7f3ff; border-radius: 10px; text-align: center;">
                <h4 style="color: #004085; margin-bottom: 15px;">
                    <i class="fas fa-rocket"></i> H·ªá th·ªëng ƒë√£ s·∫µn s√†ng!
                </h4>
                <p style="font-size: 1.1em; color: #004085;">
                    ƒêƒÉng nh·∫≠p b·∫±ng t√†i kho·∫£n c√≥ <strong>vai_tro = "Quan ly"</strong><br> s·∫Ω t·ª± ƒë·ªông chuy·ªÉn ƒë·∫øn <strong>admin.php</strong> üéâ
                </p>
            </div>
        </div>
    </div>
</body>

</html>